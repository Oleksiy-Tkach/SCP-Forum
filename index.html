<!DOCTYPE html>
<html lang="uk">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>SCP Foundation Forum</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <link rel="stylesheet" href="css/style.css">
  <link rel="stylesheet" href="css/dark-mode.css">
  <link rel="stylesheet" href="css/alerts.css">
  <script src="scripts/auth.js" defer></script>
  <script src="scripts/search.js" defer></script>
  <script src="scripts/notifications.js" defer></script>
  <script src="scripts/breach-simulator.js" defer></script>
</head>
<body>
  <!-- Залиште весь ваш HTML код без змін -->
  <!-- ... -->
  
  <script>
    // Оновлений JavaScript код
    document.addEventListener('DOMContentLoaded', function() {
      // Симуляція завантаження
      setTimeout(function() {
        document.getElementById('loading-screen').style.display = 'none';
      }, 2000);
      
      // Перевірка авторизації
      checkAuthStatus();
      
      // Ініціалізація каруселі
      initCarousel();
      
      // Завантаження випадкового SCP
      loadRandomSCP();
      
      // Ініціалізація пошуку
      initSearch();
      
      // Перевірка на випадкову тривогу
      setTimeout(checkForRandomAlert, 5000);
      
      // Додавання обробників для форм
      document.getElementById('loginForm').addEventListener('submit', function(e) {
        e.preventDefault();
        handleLogin();
      });
      
      document.getElementById('registerForm').addEventListener('submit', function(e) {
        e.preventDefault();
        handleRegister();
      });
      
      // Ініціалізація темного режиму
      if (localStorage.getItem('darkMode') === 'true') {
        document.body.classList.add('dark-mode');
      }
      
      // Додавання обробника для кнопки теми
      document.getElementById('darkModeToggle').addEventListener('click', toggleDarkMode);
    });
    
    function checkAuthStatus() {
      const username = localStorage.getItem('username');
      const clearance = localStorage.getItem('clearance');
      
      if (username) {
        document.getElementById('authButtons').style.display = 'none';
        document.getElementById('userPanel').style.display = 'flex';
        document.getElementById('welcomeUser').textContent = username;
        document.getElementById('userClearance').textContent = `Рівень ${clearance}`;
        
        // Оновлення профілю в сайдбарі
        updateProfileSummary(username, clearance);
        
        // Перевірка доступу до секретної зони
        if (parseInt(clearance) >= 5) {
          document.getElementById('secretZone').style.display = 'block';
        }
      }
    }
    
    function updateProfileSummary(username, clearance) {
      const profileSummary = document.getElementById('profileSummary');
      profileSummary.innerHTML = `
        <div class="profile-info">
          <div class="profile-avatar">
            <i class="fas fa-user-secret"></i>
          </div>
          <div class="profile-details">
            <h5>${username}</h5>
            <p>Рівень доступу: ${clearance}</p>
            <p>Статус: Активний</p>
          </div>
        </div>
        <div class="profile-actions">
          <button class="btn btn-profile" onclick="showProfile()">Профіль</button>
          <button class="btn btn-messages" onclick="showMessages()">
            <i class="fas fa-envelope"></i>
          </button>
        </div>
      `;
    }
    
    function initCarousel() {
      const items = document.querySelectorAll('.featured-item');
      let currentItem = 0;
      
      function showItem(index) {
        items.forEach(item => item.classList.remove('active'));
        items[index].classList.add('active');
        currentItem = index;
      }
      
      window.nextFeatured = function() {
        let nextIndex = currentItem + 1;
        if (nextIndex >= items.length) nextIndex = 0;
        showItem(nextIndex);
      }
      
      window.prevFeatured = function() {
        let prevIndex = currentItem - 1;
        if (prevIndex < 0) prevIndex = items.length - 1;
        showItem(prevIndex);
      }
      
      // Автоматична зміна кожні 5 секунд
      setInterval(nextFeatured, 5000);
    }
    
    function loadRandomSCP() {
      const randomSCPs = [
        { id: 'SCP-049', name: 'SCP-049', class: 'Евклід', desc: 'Лікар Чуми', img: 'scp-049.jpg' },
        { id: 'SCP-106', name: 'SCP-106', class: 'Кетер', desc: 'Старий', img: 'scp-106.jpg' },
        { id: 'SCP-173', name: 'SCP-173', class: 'Евклід', desc: 'Скульптура', img: 'scp-173.jpg' },
        { id: 'SCP-682', name: 'SCP-682', class: 'Кетер', desc: 'Незнищенна рептилія', img: 'scp-682.jpg' },
        { id: 'SCP-999', name: 'SCP-999', class: 'Безпечний', desc: 'Жива істота-желе', img: 'scp-999.jpg' }
      ];
      
      window.revealRandomSCP = function() {
        const randomSCP = randomSCPs[Math.floor(Math.random() * randomSCPs.length)];
        const scpElement = document.getElementById('randomSCP');
        
        scpElement.innerHTML = `
          <div class="scp-image">
            <img src="images/${randomSCP.img}" alt="${randomSCP.name}" onerror="this.src='data:image/svg+xml;charset=UTF-8,%3Csvg%20width%3D%22200%22%20height%3D%22200%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20viewBox%3D%220%200%20200%20200%22%20preserveAspectRatio%3D%22none%22%3E%3Cdefs%3E%3Cstyle%20type%3D%22text%2Fcss%22%3E%23holder_17c68c2b345%20text%20%7B%20fill%3A%23eceeef%3Bfont-weight%3Abold%3Bfont-family%3AArial%2C%20Helvetica%2C%20Open%20Sans%2C%20sans-serif%2C%20monospace%3Bfont-size%3A10pt%20%7D%20%3C%2Fstyle%3E%3C%2Fdefs%3E%3Cg%20id%3D%22holder_17c68c2b345%22%3E%3Crect%20width%3D%22200%22%20height%3D%22200%22%20fill%3D%22%2355595c%22%3E%3C%2Frect%3E%3Cg%3E%3Ctext%20x%3D%2274.4375%22%20y%3D%22104.5%22%3E${randomSCP.name}%3C%2Ftext%3E%3C%2Fg%3E%3C%2Fg%3E%3C%2Fsvg%3E'">
          </div>
          <div class="scp-details">
            <h5>${randomSCP.name}</h5>
            <p>Клас: ${randomSCP.class}</p>
            <p>${randomSCP.desc}</p>
            <a href="scp.html?id=${randomSCP.id}" class="btn btn-read-more">Детальніше <i class="fas fa-arrow-right"></i></a>
            <button class="btn btn-another" onclick="loadRandomSCP()">Інший SCP</button>
          </div>
        `;
      }
    }
    
    function initSearch() {
      // Заглушка для ініціалізації пошуку
      console.log("Пошук ініціалізовано");
    }
    
    function checkForRandomAlert() {
      // 15% шанс на тривогу
      if (Math.random() < 0.15) {
        const scpEvents = [
          { 
            code: 'SCP-173', 
            message: 'SCP-173 утік із камери утримання! Усі персонал повинен уникати прямого зорового контакту.',
            procedures: [
              'Не моргати при контакті з SCP-173',
              'Триматися групами не менше двох осіб',
              'Чекати інструкцій від МОГ Beta-7 ("Maz Hatters")'
            ]
          },
          { 
            code: 'SCP-106', 
            message: 'SCP-106 помічений у Секторі-19. Активовано протокол "Золота людина".',
            procedures: [
              'Уникати контакту зі стінами та підлогами',
              'Не залишатися наодинці',
              'Чекати інструкцій від МОГ Nu-7 ("Hammer Down")'
            ]
          },
          { 
            code: 'SCP-096', 
            message: 'SCP-096 активовано через несанкціоноване спостереження. Усі персонал повинен закрити очі.',
            procedures: [
              'Не дивитися на SCP-096',
              'Не переглядати жодних зображень або відео',
              'Чекати інструкцій від МОГ Epsilon-11 ("Nine-Tailed Fox")'
            ]
          }
        ];
        
        const event = scpEvents[Math.floor(Math.random() * scpEvents.length)];
        showBreachAlert(event);
      }
    }
    
    function showBreachAlert(event) {
      document.getElementById('breachCode').textContent = event.code;
      document.getElementById('breachMessage').innerHTML = `<p>${event.message}</p>`;
      
      const proceduresList = document.getElementById('breachProcedures');
      proceduresList.innerHTML = '';
      event.procedures.forEach(proc => {
        const li = document.createElement('li');
        li.textContent = proc;
        proceduresList.appendChild(li);
      });
      
      document.getElementById('breachModal').style.display = 'block';
      
      // Додаткові ефекти
      document.body.classList.add('breach-active');
      playAlertSound();
    }
    
    function acknowledgeBreach() {
      document.getElementById('breachModal').style.display = 'none';
      document.body.classList.remove('breach-active');
    }
    
    function playAlertSound() {
      // Створення та відтворення звуку через Web Audio API
      try {
        const audioContext = new (window.AudioContext || window.webkitAudioContext)();
        const oscillator = audioContext.createOscillator();
        const gainNode = audioContext.createGain();
        
        oscillator.connect(gainNode);
        gainNode.connect(audioContext.destination);
        
        oscillator.type = 'sawtooth';
        oscillator.frequency.setValueAtTime(300, audioContext.currentTime);
        oscillator.frequency.exponentialRampToValueAtTime(100, audioContext.currentTime + 1);
        
        gainNode.gain.setValueAtTime(0.3, audioContext.currentTime);
        gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 1);
        
        oscillator.start();
        oscillator.stop(audioContext.currentTime + 1);
      } catch (e) {
        console.log('Не вдалося відтворити звук: ', e);
      }
    }
    
    // Модальні вікна
    function showLoginModal() {
      document.getElementById('loginModal').style.display = 'flex';
    }
    
    function showRegisterModal() {
      closeModal('loginModal');
      document.getElementById('registerModal').style.display = 'flex';
    }
    
    function closeModal(modalId) {
      document.getElementById(modalId).style.display = 'none';
    }
    
    // Функції для обробки форми
    function handleLogin() {
      const username = document.getElementById('loginUsername').value;
      const password = document.getElementById('loginPassword').value;
      
      // Симуляція перевірки облікових даних
      if (username && password) {
        localStorage.setItem('username', username);
        localStorage.setItem('clearance', '2'); // Стандартний рівень доступу
        
        closeModal('loginModal');
        checkAuthStatus();
        
        // Додаємо сповіщення про успішний вхід
        addNotification(`Ласкаво просимо, ${username}. Рівень доступу: 2`, 'success');
      } else {
        alert('Будь ласка, заповніть всі поля');
      }
    }
    
    function handleRegister() {
      const username = document.getElementById('regUsername').value;
      const email = document.getElementById('regEmail').value;
      const password = document.getElementById('regPassword').value;
      const confirmPassword = document.getElementById('regConfirmPassword').value;
      const clearance = document.getElementById('regClearance').value;
      
      if (password !== confirmPassword) {
        alert('Паролі не співпадають');
        return;
      }
      
      if (username && email && password) {
        localStorage.setItem('username', username);
        localStorage.setItem('clearance', clearance);
        
        closeModal('registerModal');
        checkAuthStatus();
        
        // Додаємо сповіщення про успішну реєстрацію
        addNotification(`Реєстрація успішна. Ласкаво просимо, ${username}.`, 'success');
      } else {
        alert('Будь ласка, заповніть всі поля');
      }
    }
    
    function addNotification(message, type = 'info') {
      const notificationsList = document.getElementById('notificationsList');
      const notification = document.createElement('div');
      notification.className = 'notification-item';
      
      let icon = 'info-circle';
      if (type === 'success') icon = 'check-circle';
      if (type === 'warning') icon = 'exclamation-circle';
      if (type === 'danger') icon = 'radiation';
      
      notification.innerHTML = `
        <div class="notification-icon">
          <i class="fas fa-${icon}"></i>
        </div>
        <div class="notification-content">
          <p>${message}</p>
          <span class="notification-time">Щойно</span>
        </div>
      `;
      
      notificationsList.insertBefore(notification, notificationsList.firstChild);
      
      // Автоматичне видалення сповіщення через 5 секунд
      setTimeout(() => {
        notification.remove();
      }, 5000);
    }
    
    // Глобальні функції
    function toggleDarkMode() {
      document.body.classList.toggle('dark-mode');
      localStorage.setItem('darkMode', document.body.classList.contains('dark-mode'));
    }
    
    function logout() {
      localStorage.removeItem('username');
      localStorage.removeItem('clearance');
      
      document.getElementById('authButtons').style.display = 'block';
      document.getElementById('userPanel').style.display = 'none';
      document.getElementById('secretZone').style.display = 'none';
      
      // Оновлення профілю в сайдбарі
      document.getElementById('profileSummary').innerHTML = `
        <p>Будь ласка, увійдіть в систему для перегляду профілю.</p>
        <button class="btn btn-login-sidebar" onclick="showLoginModal()">Увійти</button>
      `;
      
      addNotification('Ви вийшли з системи.', 'info');
    }
    
    function showProfile() {
      alert('Функція профілю в розробці');
    }
    
    function showMessages() {
      alert('Система повідомлень в розробці');
    }
    
    function checkO5Access() {
      const password = document.getElementById('o5Password').value;
      
      // Простий перевірний код (в реальному застосунку це має бути безпечніше)
      if (password === 'O5-COMMAND' || password === '05555') {
        document.querySelector('.zone-lock').style.display = 'none';
        document.getElementById('zoneContent').style.display = 'block';
        addNotification('Доступ O5 надано. Ласкаво просимо, Рада O5.', 'success');
      } else {
        alert('НЕВІРНИЙ КОД ДОСТУПУ. СПРОБУ ЗАРЕЄСТРОВАНО.');
        addNotification('Спроба несанкціонованого доступу до зони O5.', 'danger');
      }
    }
    
    function viewDocument(docId) {
      const modal = document.getElementById('documentModal');
      const title = document.getElementById('documentTitle');
      const content = document.getElementById('documentContent');
      
      // Заглушки для документів
      const documents = {
        'pandora': {
          title: 'Проект "Pandora\'s Box"',
          clearance: 'Рівень доступу: O5',
          author: 'Автор: Д-р █████',
          date: 'Дата: ██/██/████',
          content: '<p>Інформація про проект "Pandora\'s Box" засекречена навіть для більшості членів Ради O5. Лише O5-1 та O5-2 мають повний доступ до цієї інформації.</p><p>Проект стосується потенційного сценарію CK-класу "Повне знищення реальності".</p>'
        },
        'scp001': {
          title: 'Звіт про SCP-001',
          clearance: 'Рівень доступу: O5',
          author: 'Автор: Рада O5',
          date: 'Дата: ██/██/████',
          content: '<p>Існує кілька пропозицій щодо SCP-001. Жодна з них не може бути підтверджена або спростована без ризику катастрофічних наслідків.</p><p>Деякі з пропозицій включають: "Світовий сад", "Ковчег", "Список", "Фонд" та інші.</p>'
        },
        'endworld': {
          title: 'Протокол "Кінець Світу"',
          clearance: 'Рівень доступу: O5',
          author: 'Автор: O5-██',
          date: 'Дата: ██/██/████',
          content: '<p>Протокол "Кінець Світу" активується лише у випадку події CK-класу "Повне знищення реальності".</p><p>Протокол включає евакуацію ключового персоналу до Альфа-Бази та активацію системи "Фенікс".</p>'
        }
      };
      
      if (documents[docId]) {
        title.textContent = documents[docId].title;
        document.getElementById('documentClearance').textContent = documents[docId].clearance;
        document.getElementById('documentAuthor').textContent = documents[docId].author;
        document.getElementById('documentDate').textContent = documents[docId].date;
        content.innerHTML = documents[docId].content;
        
        modal.style.display = 'flex';
      }
    }
    
    function printDocument() {
      alert('Функція друку в розробці');
    }
    
    function downloadDocument() {
      alert('Функція завантаження в розробці');
    }
    
    function searchSCP() {
      const query = document.getElementById('searchInput').value.toLowerCase();
      const category = document.getElementById('searchCategory').value;
      const clearance = document.getElementById('searchClearance').value;
      
      // Заглушка для пошуку
      const resultsContainer = document.getElementById('searchResults');
      
      if (query.length < 2) {
        resultsContainer.innerHTML = '';
        return;
      }
      
      // Симуляція результатів пошуку
      resultsContainer.innerHTML = `
        <div class="scp-result">
          <h4>SCP-${query.toUpperCase()}</h4>
          <p class="object-class">Клас об'єкта: █████</p>
          <p>Результати пошуку для "${query}". Інформація обмежена вашим рівнем доступу.</p>
          <a href="#" class="btn-read-more">Запит доступу <i class="fas fa-arrow-right"></i></a>
        </div>
        <div class="scp-result">
          <h4>Документ: ${query}</h4>
          <p>Категорія: ${category}</p>
          <p>Документ знайдено, але доступ обмежений. Запит підвищення рівня доступу може бути поданий через адміністратора.</p>
          <a href="#" class="btn-read-more">Запит доступу <i class="fas fa-arrow-right"></i></a>
        </div>
      `;
    }
    
    function expandSearch() {
      document.querySelector('.search-box').classList.add('expanded');
    }
    
    function showRules() {
      alert('Правила форуму:\n\n1. Не поширюйте інформацію про місцезнаходження об\'єктів\n2. Не намагайтеся відтворити SCP-об\'єкти\n3. Дотримуйтесь свого рівня доступу\n4. Не розголошуйте інформацію про персонал');
    }
  </script>
</body>
</html>
